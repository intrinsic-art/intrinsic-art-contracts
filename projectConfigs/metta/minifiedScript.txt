console.log("Metta v4.1 \xa9 2023 Matto"),console.log(`TOKEN ID: ${artwork.tokenID}`),console.log(`TOKEN ENTROPY: ${artwork.seed}`),console.log("");let tokenId=artwork.tokenID,tokenEntropy=artwork.seed,tokenEntropyPairs=createPairs(tokenEntropy),p=[],matte=16,hue,u,nodes,freeze,reach,connections,thickness,fade,cellDesign,cellColorMode,gradientShift,seekerNodeMod,paused=!0,count=0,R=(e=1)=>Math.floor(random()*e);function setup(){let e,t;window.innerWidth>window.innerHeight?(t=.5625*(e=window.innerWidth))>window.innerHeight&&(e=(t=window.innerHeight)/.5625):(e=.5625*(t=window.innerHeight))>window.innerWidth&&(t=(e=window.innerWidth)/.5625),createCanvas(e,t),colorMode(HSL,360,100,100);randomSeed(getValue(0,255)*getValue(0,255)*getValue(0,255)*getValue(0,255)),hue=20*getValue(1,18),nodes="Minimum"==artwork.traits.nodes?5:"Low"==artwork.traits.nodes?20:"Medium"==artwork.traits.nodes?60:125,connections="Low"==artwork.traits.connections?2:"Medium"==artwork.traits.connections?4:10,thickness="Micron 003"==artwork.traits.thickness?0:"Micron 01"==artwork.traits.thickness?1:2,fade="Yes"==artwork.traits.fade,cellDesign="Lines & Walls"==artwork.traits.cellDesign?0:"Startrail"==artwork.traits.cellDesign?1:"Popcorn"==artwork.traits.cellDesign?2:"Shards"==artwork.traits.cellDesign?3:4,cellColorMode="Tri-X"==artwork.traits.cellColorMode?0:"Synchonized"==artwork.traits.cellColorMode?1:"Agree to Disaggree"==artwork.traits.cellColorMode?2:3,ringColorMode="Invisible"==artwork.traits.ringColorMode?2:"Tri-X"==artwork.traits.ringColorMode?0:1,reach="Low"==artwork.traits.reach?0:"Medium"==artwork.traits.reach?1:2,gradientShift=getValue(0,360),frameRate(freeze=95),seekerNodeMod=5==nodes?3:Math.floor(nodes/2),u=(thickness+1)*(window.innerHeight+window.innerWidth)/4e3,fade?background(10):background(0);for(let o=0;o<nodes;o++)p.push({x:R(1.5*e)-e/4,y:R(1.5*t)-t/4,r:0,c:[R(70)+20,R(90)+10]}),0==o&&(0==cellColorMode?console.log("(Palette: B/W)"):3==cellColorMode?console.log("(Palette: Gradient)"):(console.log("(Primary Hue: "+hue+")"),2==cellColorMode&&console.log("(Secondary Hue: "+(hue+180)%360+")")))}function draw(){if(!paused||count<freeze){++count<freeze?frameRate(freeze-count+3):frameRate(30),fade&&(fill(0,100,0,.02),noStroke(),rect(0,0,width,height)),noFill();for(let e=0;e<1e3;e++){let t=R(width),o=R(height),n=width**3,r,i;for(let l=0;l<p.length;l++)(i=dist(t,o,p[l].x,p[l].y))<n&&(n=i,r=l);strokeWeight(.5*u);let $,a;0==cellColorMode?($=hue,a=0):1==cellColorMode?($=hue,a=p[r].c[0]):2==cellColorMode?r%2==0?($=hue,a=p[r].c[0]):($=(hue+180)%360,a=p[r].c[0]):3==cellColorMode&&(tokenId%3==0?($=p[r].x/width*360+gradientShift,a=p[r].c[0]):tokenId%3==1?($=p[r].y/height*360+gradientShift,a=p[r].c[0]):($=(p[r].x+p[r].y)/(width+height)*360+gradientShift,a=p[r].c[0])),stroke($,a,p[r].c[1]);let s=p[r].x-t,c=p[r].y-o,d=20*Math.sqrt(s*s+c*c),h=p[r].x+.75*(t-p[r].x),_=p[r].y+.75*(o-p[r].y),g=p[r].x+1.1*(t-p[r].x),y=p[r].y+1.1*(o-p[r].y),f=s/d,x=c/d,M,k,m=1==cellDesign?d/20:0==cellDesign?d/30:d/40,C=t+-x*m,D=o+f*m,P=t+x*m,E=o+-f*m;if(0==cellDesign)0==reach?line(p[r].x,p[r].y,h,_):1==reach?line(p[r].x,p[r].y,t,o):line(p[r].x,p[r].y,g,y),line(C,D,P,E);else if(1==cellDesign){let w;w=0==reach?.75*n:1==reach?n:1.25*n;let N=Math.atan2(D-p[r].y,C-p[r].x),S=Math.atan2(E-p[r].y,P-p[r].x);arc(p[r].x,p[r].y,2*w,2*w,N,S)}else if(2==cellDesign)fill($,a,p[r].c[1]),0==reach?circle(h,_,1.5*u):1==reach?circle(t,o,1.5*u):circle(g,y,1.5*u),noFill();else if(3==cellDesign){let I=0==reach?.7:.9;reach<2&&(C=p[r].x+I*(C-p[r].x),D=p[r].y+I*(D-p[r].y),P=p[r].x+I*(P-p[r].x),E=p[r].y+I*(E-p[r].y)),0==reach?quad(p[r].x,p[r].y,C,D,h,_,P,E):1==reach?quad(p[r].x,p[r].y,C,D,t,o,P,E):quad(h,_,C,D,g,y,P,E)}n>p[r].r&&(p[r].r=n,strokeWeight(50/p[r].r*u),ringColorMode<2&&(0==ringColorMode?stroke(0,0,p[r].c[1]):1==ringColorMode&&stroke(hue,p[r].c[0],p[r].c[1]),circle(p[r].x,p[r].y,2*p[r].r)))}moveTowardNClosest(connections)}}function moveTowardNClosest(e){for(let t=0;t<p.length;t++){let o=[];for(let n=0;n<p.length;n++)if(t!==n){let r=dist(p[t].x,p[t].y,p[n].x,p[n].y);o.push({dist:r,point:p[n]})}o.sort((e,t)=>e.dist-t.dist);let i=o[0].dist;strokeWeight(2*u),circle(p[t].x,p[t].y,3*u);for(let l=0;l<e&&l<o.length;l++){let $=u/Math.pow(1.5,l);line(p[t].x,p[t].y,o[l].point.x,o[l].point.y),strokeWeight($*u);let a=1/(500*Math.pow(2,l));0!=t&&t%seekerNodeMod==0&&(a*=10),p[t].x+=(o[l].point.x-p[t].x)*a,p[t].y+=(o[l].point.y-p[t].y)*a}if(i<=5){if(p[t].x=R(1.5*width)-width/4,p[t].y=R(1.5*height)-height/4,p[t].r=0,0==t){let s=tokenId%2==0?hue-10:hue+10;s<0?s=360+s:s>360&&(s-=360),hue=s,console.log("(New hue: "+hue+")")}p[t].c=[R(70)+20,R(90)+10]}}}function createPairs(e){let t=[];for(let o=0;o<(e.length-2)/2;o++)t.push(parseInt(e.slice(2+2*o,4+2*o),16));return t}function getValue(e,t){if(0===tokenEntropyPairs.length)throw Error("No entropy values left in tokenEntropyPairs.");let o=Math.floor(tokenEntropyPairs[0]*((t-e+1)/256)+e);return tokenEntropyPairs.shift(),o}function doubleClicked(){paused=!paused}function keyPressed(){return"p"===key||"P"===key?paused=!paused:"s"===key||"S"===key?saveCanvas(`Community-${tokenId}_${tokenEntropy}`,"png"):"<"===key?(0!=matte?matte--:matte=16,updateMatte()):">"===key&&(16!=matte?matte++:matte=0,updateMatte()),!1}function updateMatte(){document.body.style.backgroundColor=`rgb(${16*matte},${16*matte},${16*matte})`}